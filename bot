import requests
from bs4 import BeautifulSoup as BS
import telebot
from telebot import types
import requests
from bs4 import BeautifulSoup

bot = telebot.TeleBot('5428032980:AAEqBDYLnHD3Xni_lRIPy1ttk2khC1hVfho')
pep=0
@bot.message_handler(commands=['start'])
def start(message):
    markup=types.ReplyKeyboardMarkup(resize_keyboard=True)
    item1=types.KeyboardButton("ğŸ“ˆĞšÑƒÑ€Ñ")
    item2=types.KeyboardButton("âš™ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸")
    markup.add(item1,item2)
    bot.send_message(message.chat.id,'ĞŸÑ€Ğ¸Ğ²ĞµÑ‚', reply_markup=markup)


@bot.message_handler(content_types=['text'])
def bot_message(message):
    global pep
    global valut
    if message.chat.type=='private':
        if message.text=='ğŸ“ˆĞšÑƒÑ€Ñ':
            bit='https://coinmarketcap.com/currencies/bitcoin/'
            headers={"User-Agent":'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36'}
            bitok=requests.get(bit,headers=headers)
            bitcoin=BeautifulSoup(bitok.text,'lxml')
            data=bitcoin.find('div',class_='priceValue',)
            priceb=data.find('span').text.replace("\n",'').replace(",","").replace("$","")
            priceb=priceb[:-3]
            ethereum='https://coinmarketcap.com/currencies/ethereum/'
            ether=requests.get(ethereum,headers=headers)
            ethe=BeautifulSoup(ether.text,'lxml')
            eth=ethe.find('div',class_='priceValue',)
            pricee=eth.find('span').text.replace("\n",'').replace(",",'').replace("$","")
            pricee=pricee[:-3]
            litecoin='https://coinmarketcap.com/currencies/litecoin/'
            liteco=requests.get(litecoin,headers=headers)
            litec=BeautifulSoup(liteco.text,'lxml')
            lite=litec.find('div',class_='priceValue',)
            pricel=lite.find('span').text.replace("\n",'').replace(",",'').replace("$","")
            if pep==1:
                v='https://wise.com/gb/currency-converter/usd-to-rub-rate'
                headers={"User-Agent":'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36'}
                va=requests.get(v,headers=headers)
                val=BeautifulSoup(va.text,'lxml')
                dok=val.find('h3',class_='cc__source-to-target',)
                ruk=dok.find('span',class_='text-success',).text.replace("\n",'')
                ruk=ruk[:-3]
                ruk=float(ruk)
                priceb=float(priceb)
                pricee=float(pricee)
                pricel=float(pricel)
                bot.send_message(message.chat.id,f'ğŸ“ˆĞšÑƒÑ€Ñ \U0001f7e1Ğ‘Ğ¸Ñ‚ĞºĞ¾Ğ¸Ğ½Ğ°={priceb*ruk}â‚½\nğŸ“ˆĞšÑƒÑ€Ñ ğŸ”µĞ­Ñ„Ğ¸Ñ€Ğ¸ÑƒĞ¼Ğ°={pricee*ruk}â‚½\nğŸ“ˆĞšÑƒÑ€Ñ ğŸ”¹Ğ›Ğ°Ğ¹Ñ‚ĞºĞ¾Ğ¸Ğ½Ğ°={pricel*ruk}â‚½')
            else:
                bot.send_message(message.chat.id,f'ğŸ“ˆĞšÑƒÑ€Ñ \U0001f7e1Ğ‘Ğ¸Ñ‚ĞºĞ¾Ğ¸Ğ½Ğ°={priceb}$\nğŸ“ˆĞšÑƒÑ€Ñ ğŸ”µĞ­Ñ„Ğ¸Ñ€Ğ¸ÑƒĞ¼Ğ°={pricee}$\nğŸ“ˆĞšÑƒÑ€Ñ ğŸ”¹Ğ›Ğ°Ğ¹Ñ‚ĞºĞ¾Ğ¸Ğ½Ğ°={pricel}$')
        elif message.text=='âš™ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸':
            markup=types.ReplyKeyboardMarkup(resize_keyboard=True)
            item9=types.KeyboardButton("âªĞĞ°Ğ·Ğ°Ğ´")
            item4=types.KeyboardButton("ğŸ’±Ğ’Ğ°Ğ»ÑÑ‚Ğ°")
            item3=types.KeyboardButton("ğŸ³Ğ¯Ğ·Ñ‹Ğº")
            markup.add(item3,item4,item9)
            bot.send_message(message.chat.id,'âš™ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸', reply_markup=markup)

        elif message.text=="ğŸ³Ğ¯Ğ·Ñ‹Ğº":
            markup=types.ReplyKeyboardMarkup(resize_keyboard=True)
            item5=types.KeyboardButton("ğŸ‡ºğŸ‡¸English")
            item6=types.KeyboardButton("ğŸ‡·ğŸ‡ºĞ ÑƒÑÑĞºĞ¸Ğ¹")
            item9=types.KeyboardButton("âªĞĞ°Ğ·Ğ°Ğ´")
            markup.add(item5,item6,item9)
            bot.send_message(message.chat.id,'ğŸ³Ğ¯Ğ·Ñ‹Ğº', reply_markup=markup)
        elif message.text=='âªĞĞ°Ğ·Ğ°Ğ´':
            markup=types.ReplyKeyboardMarkup(resize_keyboard=True)
            item1=types.KeyboardButton("ğŸ“ˆĞšÑƒÑ€Ñ")
            item2=types.KeyboardButton("âš™ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸")
            markup.add(item1,item2)
            bot.send_message(message.chat.id,'Ğ“Ğ»Ğ°Ğ²Ğ½Ğ¾Ğµ Ğ¼ĞµĞ½Ñ', reply_markup=markup)
        elif message.text=="ğŸ’±Ğ’Ğ°Ğ»ÑÑ‚Ğ°":
            markup=types.ReplyKeyboardMarkup(resize_keyboard=True)
            item7=types.KeyboardButton("â‚½ Ğ ÑƒĞ±Ğ»ÑŒ")
            item8=types.KeyboardButton("ğŸ’²Ğ”Ğ¾Ğ»Ğ»Ğ°Ñ€")
            item9=types.KeyboardButton("âªĞĞ°Ğ·Ğ°Ğ´")
            markup.add(item7,item8,item9)
            bot.send_message(message.chat.id,'ğŸ’±Ğ’Ğ°Ğ»ÑÑ‚Ğ°', reply_markup=markup)
        elif message.text=="ğŸ‡·ğŸ‡ºĞ ÑƒÑÑĞºĞ¸Ğ¹":
            markup=types.ReplyKeyboardMarkup(resize_keyboard=True)
            item1=types.KeyboardButton("ğŸ“ˆĞšÑƒÑ€Ñ")
            item2=types.KeyboardButton("âš™ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸")
            markup.add(item1,item2)
            bot.send_message(message.chat.id,'Ğ“Ğ»Ğ°Ğ²Ğ½Ğ¾Ğµ Ğ¼ĞµĞ½Ñ', reply_markup=markup)
        elif message.text=="ğŸ‡ºğŸ‡¸English":
            markup=types.ReplyKeyboardMarkup(resize_keyboard=True)
            item7=types.KeyboardButton("ğŸ“ˆRate")
            item9=types.KeyboardButton("âš™Settings")
            markup.add(item7,item9)
            bot.send_message(message.chat.id,'Main menu', reply_markup=markup)
        elif message.text=="ğŸ“ˆRate":
             bit='https://coinmarketcap.com/currencies/bitcoin/'
             headers={"User-Agent":'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36'}
             bitok=requests.get(bit,headers=headers)
             bitcoin=BeautifulSoup(bitok.text,'lxml')
             data=bitcoin.find('div',class_='priceValue',)
             priceb=data.find('span').text.replace("\n",'').replace(",",'').replace("$","")
             priceb=priceb[:-3]
             ethereum='https://coinmarketcap.com/currencies/ethereum/'
             ether=requests.get(ethereum,headers=headers)
             ethe=BeautifulSoup(ether.text,'lxml')
             eth=ethe.find('div',class_='priceValue',)
             pricee=eth.find('span').text.replace("\n",'').replace(",",'').replace("$","")
             pricee=pricee[:-3]
             litecoin='https://coinmarketcap.com/currencies/litecoin/'
             liteco=requests.get(litecoin,headers=headers)
             litec=BeautifulSoup(liteco.text,'lxml')
             lite=litec.find('div',class_='priceValue',)
             pricel=lite.find('span').text.replace("\n",'').replace(",",'').replace("$","")
             if pep==1:
                v='https://wise.com/gb/currency-converter/usd-to-rub-rate'
                headers={"User-Agent":'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36'}
                va=requests.get(v,headers=headers)
                val=BeautifulSoup(va.text,'lxml')
                dok=val.find('h3',class_='cc__source-to-target',)
                ruk=dok.find('span',class_='text-success',).text.replace("\n",'')
                ruk=ruk[:-3]
                ruk=float(ruk)
                priceb=float(priceb)
                pricee=float(pricee)
                pricel=float(pricel)
                bot.send_message(message.chat.id,f'\U0001f7e1Bitcoin ğŸ“ˆrate={priceb*ruk}â‚½ \nğŸ”µEthereum ğŸ“ˆrate={pricee*ruk}â‚½ \nğŸ”¹Litecoin ğŸ“ˆrate={pricel*ruk}â‚½ ')
             else:
                bot.send_message(message.chat.id,f'\U0001f7e1Bitcoin ğŸ“ˆrate={priceb}$\nğŸ”µEthereum ğŸ“ˆrate={pricee}$\nğŸ”¹Litecoin ğŸ“ˆrate={pricel}$')
        elif message.text=="âš™Settings":
            markup=types.ReplyKeyboardMarkup(resize_keyboard=True)
            item9=types.KeyboardButton("âªBack")
            item4=types.KeyboardButton("ğŸ’±Currency")
            item3=types.KeyboardButton("ğŸ³Language")
            markup.add(item3,item4,item9)
            bot.send_message(message.chat.id,'âš™Settings', reply_markup=markup)
        elif message.text=="ğŸ’±Currency":
            markup=types.ReplyKeyboardMarkup(resize_keyboard=True)
            item7=types.KeyboardButton("â‚½ Ruble")
            item8=types.KeyboardButton("ğŸ’²Dollar")
            item9=types.KeyboardButton("âªBack")
            markup.add(item7,item8,item9)
            bot.send_message(message.chat.id,'âš™Settings', reply_markup=markup)
        elif message.text=='âªBack':
            markup=types.ReplyKeyboardMarkup(resize_keyboard=True)
            item1=types.KeyboardButton("ğŸ“ˆRate")
            item2=types.KeyboardButton("âš™Settings")
            markup.add(item1,item2)
            bot.send_message(message.chat.id,'Main menu', reply_markup=markup)
        elif message.text=="ğŸ³Language":
            markup=types.ReplyKeyboardMarkup(resize_keyboard=True)
            item5=types.KeyboardButton("ğŸ‡ºğŸ‡¸English")
            item6=types.KeyboardButton("ğŸ‡·ğŸ‡ºĞ ÑƒÑÑĞºĞ¸Ğ¹")
            item9=types.KeyboardButton("âªBack")
            markup.add(item5,item6,item9)
            bot.send_message(message.chat.id,'ğŸ³Language', reply_markup=markup)
        elif message.text=="â‚½ Ruble":
            markup=types.ReplyKeyboardMarkup(resize_keyboard=True)
            item7=types.KeyboardButton("ğŸ“ˆRate")
            item9=types.KeyboardButton("âš™Settings")
            markup.add(item7,item9)
            pep=1
            bot.send_message(message.chat.id,'Main menu', reply_markup=markup)
        elif message.text=='ğŸ’²Ğ”Ğ¾Ğ»Ğ»Ğ°Ñ€':
            markup=types.ReplyKeyboardMarkup(resize_keyboard=True)
            item1=types.KeyboardButton("ğŸ“ˆĞšÑƒÑ€Ñ")
            item2=types.KeyboardButton("âš™ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸")
            valut="ğŸ’²"
            markup.add(item1,item2)
            bot.send_message(message.chat.id,'Ğ“Ğ»Ğ°Ğ²Ğ½Ğ¾Ğµ Ğ¼ĞµĞ½Ñ', reply_markup=markup)
        elif message.text=='â‚½ Ğ ÑƒĞ±Ğ»ÑŒ':
            markup=types.ReplyKeyboardMarkup(resize_keyboard=True)
            item1=types.KeyboardButton("ğŸ“ˆĞšÑƒÑ€Ñ")
            item2=types.KeyboardButton("âš™ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸")
            pep=1
            markup.add(item1,item2)
            bot.send_message(message.chat.id,'Ğ“Ğ»Ğ°Ğ²Ğ½Ğ¾Ğµ Ğ¼ĞµĞ½Ñ', reply_markup=markup)



bot.polling(none_stop=True)
